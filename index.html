<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Catalyst Assam</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* ==========================================================================
           PART 1: HOME PAGE CSS (EXACT COPY FROM YOUR INDEX.HTML)
           ========================================================================== */
        .home-view { display: block; } /* Initially Visible */
        .form-view { display: none; }  /* Initially Hidden */

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background-color: #fffcf0; color: #333; }
        
        /* Header Section */
        .home-header { background-color: #1a0066; color: white; text-align: center; padding: 25px; border-bottom: 5px solid yellow; }
        
        /* LOGO STYLE */
        .logo-img { 
            width: 80px; 
            height: 80px; 
            border-radius: 50%; 
            border: 3px solid white; 
            vertical-align: middle; 
            margin-right: 15px; 
            object-fit: cover; 
            background-color: white; 
        }
        
        .home-h1 { display: inline-block; margin: 0; font-size: 2.8rem; vertical-align: middle; text-transform: uppercase; }
        .home-p { letter-spacing: 8px; font-weight: bold; margin: 10px 0 0 0; text-transform: uppercase; }
        
        .red-banner { background-color: #ff0000; color: #ffff00; text-align: center; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .red-banner h2 { font-size: 2.2rem; margin: 0; text-transform: uppercase; }
        .subjects { color: white; margin-top: 10px; font-size: 1.1rem; line-height: 1.6; font-weight: bold; text-transform: uppercase; }
        
        .home-container { display: flex; flex-wrap: wrap; justify-content: space-around; padding: 30px; background: linear-gradient(to bottom, #fffcf0, #fff); }
        .column { flex: 1; min-width: 320px; padding: 20px; }
        
        .img-fluid { 
            width: 100%; 
            max-width: 400px; 
            border-radius: 12px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
            display: block; 
            margin-bottom: 15px; 
            object-fit: cover; 
        }
        
        .teacher-photo { width: 150px; height: 150px; border-radius: 50%; border: 4px solid red; object-fit: cover; background: #eee; margin-bottom: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        
        /* Style for Pulen Sir Photo (FULL PHOTO FIX) */
        .pulen-photo {
            width: 130px;       
            height: auto;       
            border-radius: 10px;
            border: 4px solid #1a0066; 
            display: block;
            margin: 10px auto;
            background-color: #eee;
        }

        h3.section-title { color: #1a0066; border-bottom: 3px solid #1a0066; display: inline-block; margin-bottom: 15px; text-transform: uppercase; font-size: 1.3rem; }
        .home-ul { list-style: none; padding: 0; }
        .home-ul li { font-size: 1.05rem; margin-bottom: 12px; font-weight: 500; }
        .home-ul li::before { content: "‚û§ "; color: red; font-weight: bold; margin-right: 5px; }
        
        .admission-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .admission-circle { background: radial-gradient(circle, #0055ff, #0022aa); color: white; width: 170px; height: 170px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: bold; font-size: 1.4rem; box-shadow: 0 10px 20px rgba(0,0,0,0.3); animation: pulse 2s infinite; text-transform: uppercase; line-height: 1.2; cursor: pointer; }
        
        .form-btn { background-color: red; color: yellow; padding: 10px 25px; border-radius: 30px; font-weight: bold; margin-top: 20px; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.3); text-decoration: none; display: inline-block; border: 2px solid yellow; transition: transform 0.2s; text-align: center; }
        .form-btn:hover { transform: scale(1.05); background-color: #cc0000; }

        .map-btn {
            display: flex;
            align-items: center;
            margin-top: 15px;
            text-decoration: none;
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid #1a0066;
            color: #1a0066;
            font-weight: bold;
            transition: 0.3s;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        .map-btn:hover { background-color: #e6e6ff; transform: scale(1.05); }
        .map-icon-small { width: 24px; height: 24px; margin-right: 8px; }

        .teacher-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center; border-top: 5px solid red; }
        
        footer { text-align: center; background-color: #0000cc; color: white; margin-top: 30px; }
        .footer-red { background: red; padding: 15px; font-weight: bold; font-size: 1.3rem; text-transform: uppercase; }
        .contact-box { padding: 20px; font-size: 1.1rem; font-weight: bold; }
        .loc-box { background: #1a0066; padding: 15px; font-size: 1.1rem; font-weight: bold; text-transform: uppercase; }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @media (max-width: 800px) { .container { flex-direction: column; } .column { min-width: 100%; padding: 10px; } .home-h1 { font-size: 1.8rem; } }

        /* ==========================================================================
           PART 2: FORM PAGE CSS (EXACT COPY FROM YOUR ADMISSION.HTML)
           ========================================================================== */
        .form-header { background-color: #1a0066; color: white; text-align: center; padding: 20px; border-bottom: 5px solid yellow; }
        .form-header h1 { margin: 0; font-size: 2rem; text-transform: uppercase; }
        .form-container { padding: 30px; max-width: 650px; margin: auto; }
        
        .form-box { background: white; padding: 30px; border-radius: 15px; border: 3px solid red; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2.form-title { color: #1a0066; text-align: center; text-transform: uppercase; text-decoration: underline; margin-bottom: 25px; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #1a0066; font-size: 1.05rem; }
        input, select, textarea { width: 100%; padding: 12px; border: 2px solid #ccc; border-radius: 5px; box-sizing: border-box; font-size: 1rem; transition: border 0.3s; }
        input:focus, select:focus, textarea:focus { border-color: #0044ff; outline: none; }
        
        /* PHOTO UPLOAD */
        .photo-upload-box { text-align: center; margin-bottom: 20px; padding: 15px; border: 2px dashed #1a0066; border-radius: 10px; background: #f0f8ff; }
        .photo-frame { width: 140px; height: 180px; border: 3px solid red; background: #ddd; overflow: hidden; border-radius: 5px; margin: 0 auto 10px auto; position: relative; }
        .photo-preview { width: 100%; height: 100%; object-fit: cover; object-position: top center; transition: object-position 0.2s ease; }
        .adjust-btn { background: #1a0066; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; margin: 0 5px; }
        .adjust-btn:hover { background: #0044ff; }
        
        /* CONTROLS */
        .radio-container { display: flex; gap: 20px; margin-top: 5px; flex-wrap: wrap; }
        .radio-label { display: flex; align-items: center; gap: 8px; font-weight: bold; cursor: pointer; font-size: 1rem; }
        input[type="radio"], input[type="checkbox"] { width: 20px; height: 20px; accent-color: red; cursor: pointer; }
        
        /* SAVE BUTTON (Initial State Hidden) */
        .save-btn-small { 
            background-color: #28a745; color: white; border: none; padding: 10px 20px; 
            border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 15px; 
            display: none; width: 100%; text-transform: uppercase; 
        }
        .saved-list { 
            margin-top: 10px; padding: 10px; background: #e6ffe6; 
            border-left: 5px solid green; font-weight: bold; display: none; 
        }
        
        /* SUBMIT BUTTON */
        .submit-btn { background-color: #ccc; color: white; border: none; padding: 15px; width: 100%; border-radius: 30px; cursor: not-allowed; font-weight: bold; font-size: 1.2rem; text-transform: uppercase; margin-top: 20px; }
        .submit-btn.active { background-color: #0044ff; cursor: pointer; }
        
        /* LOADING & SUCCESS */
        #loading-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; text-align: center; color: white; padding-top: 200px; }
        #success-message { display: none; text-align: center; background: #e6ffe6; padding: 30px; border-radius: 15px; border: 3px solid green; }
        .hidden-el { display: none; } /* Renamed to avoid conflict */
        
        .dob-container { display: flex; gap: 15px; }
        .dob-box { flex: 1; }
        .age-box { flex: 1; }
        input[readonly] { background-color: #e9ecef; }
        .magic-box { background: #f0f8ff; padding: 15px; border: 2px dashed #0044ff; border-radius: 10px; margin-bottom: 15px; }

        /* RECEIPT DESIGN (PDF ke liye) */
        #receipt-template {
            display: none; /* Initially Hidden */
            padding: 30px; background: white; border: 5px solid #1a0066; margin-top: 20px; color: black;
        }
        .rec-header { text-align: center; border-bottom: 3px solid #1a0066; padding-bottom: 15px; margin-bottom: 20px; }
        .rec-row { display: flex; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .rec-label { font-weight: bold; width: 40%; color: #1a0066; }
        .rec-val { width: 60%; font-weight: bold; }

        /* APP NAVIGATION BUTTON (Home to Form) */
        .go-back-btn {
            background-color: #333; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin-bottom: 20px; font-weight: bold;
        }
    </style>
</head>
<body>

    <div id="homeView" class="home-view">
        <header class="home-header">
            <img src="logo.png" alt="Logo" class="logo-img">
            <h1 class="home-h1">THE CATALYST ASSAM</h1>
            <p class="home-p">SHAPING TALENT</p>
        </header>

        <div class="red-banner">
            <h2>SEBA & CBSE</h2>
            <div style="font-size: 1.1rem; color: yellow; font-weight:bold; margin-bottom: 5px;">(ASSAMESE & ENGLISH MEDIUM)</div>
            <div class="subjects">
                | MATHS | SCIENCE | ENGLISH | SOCIAL SCIENCE | ECONOMICS | COMMERCE |<br>
                Classes ‚Äì | 6th | 7th | 8th | 9th | 10th | 11th | 12th |
            </div>
        </div>

        <div class="home-container">
            <div class="column">
                <img src="student.jpg" alt="Student Holding Books" class="img-fluid">
                <h3 class="section-title">HIGHLIGHTS</h3>
                
                <div style="text-align: center; margin-bottom: 15px;">
                    <img src="pulen.jpg" alt="Mr. Pulen Rahang" class="pulen-photo">
                    <div style="font-weight: bold; color: #1a0066; font-size: 1.1rem;">MR. PULEN RAHANG</div>
                </div>

                <ul class="home-ul">
                    <li>Special Teaching Quality by Well Qualified Teachers.</li>
                    <li>Individual Attention.</li>
                    <li>Regular Class Test.</li>
                    <li>Doubt Clearing Session.</li>
                </ul>
            </div>

            <div class="column admission-wrapper">
                <div class="admission-circle" onclick="switchToForm()">Admission<br>Open</div>
                
                <div class="form-btn" onclick="switchToForm()">üìù Admission Form Link</div>
                
                <a href="https://www.google.com/maps/search/?api=1&query=Mayong+Bazar&query_place_id=ChIJw_CjE7PlWjcREIuR6lXQMg0" target="_blank" class="map-btn">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/39/Google_Maps_icon_%282015-2020%29.svg" alt="Map" class="map-icon-small">
                    Locate on Google Map (‡¶Æ‡¶æ‡¶Ø‡¶º‡¶Ç ‡¶¨‡¶ú‡¶æ‡ß∞)
                </a>

            </div>

            <div class="column">
                <h3 class="section-title">COMPETITIVE EXAMS COURSES</h3>
                <ul class="home-ul">
                    <li>ADRE</li>
                    <li>ASSAM POLICE</li>
                    <li>ASSAM TET</li>
                    <li>DHS</li>
                    <li>OTHERS.</li>
                </ul>
                <div class="teacher-card" style="margin-top: 30px;">
                    <img src="teacher.png" alt="Mr. Nitu Sarkar" class="teacher-photo">
                    <div style="color:red; font-weight:bold; font-size:1.4rem; margin-top:5px; text-transform:uppercase;">MR. NITU SARKAR</div>
                    <div style="font-weight:bold; color: red; font-size: 0.95rem;">B.TECH, NIT RAIPUR<br>(APSC MAINS APPEARED)</div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-red">‚ñ∂ Special classes for class 9th and 10th students</div>
            <div class="contact-box">
                üìû 7578911831, 9399409013 <span style="margin: 0 10px;">|</span> Email - thecatalystassam@gmail.com
            </div>
            <div class="loc-box">
                üìç MAYONG BAZAR, RAJAMAYONG, MORIGAON (ASSAM) 782411
            </div>
        </footer>
    </div>

    <div id="formView" class="form-view">
        <div id="loading-overlay">
            <div style="font-size: 3rem;">üöÄ</div>
            <h2>Submitting Form...</h2>
            <p>Uploading Photo & Saving Data securely.</p>
            <p>Please wait...</p>
        </div>

        <header class="form-header">
            <h1>The Catalyst Assam</h1>
            <p style="letter-spacing: 5px; font-weight: bold; margin: 5px 0 0 0;">ADMISSION PORTAL</p>
        </header>

        <div class="form-container">
            
            <button class="go-back-btn" onclick="switchToHome()">‚¨Ö Back to Home</button>

            <div id="form-section" class="form-box">
                <h2 class="form-title">NEW STUDENT ADMISSION FORM</h2>
                
                <form id="my-form" oninput="checkFormValidity()">
                    
                    <div class="photo-upload-box">
                        <label style="margin-bottom:10px; display:block; font-weight:bold;">Upload Student Photo (Passport Size):</label>
                        <div class="photo-frame">
                            <img id="preview-img" src="https://via.placeholder.com/140x180?text=Photo" class="photo-preview" alt="Student Photo">
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="font-size:0.8rem; font-weight:bold;">Adjust Face: </span>
                            <button type="button" class="adjust-btn" onclick="movePhoto(-10)">‚¨Ü Up</button>
                            <button type="button" class="adjust-btn" onclick="movePhoto(10)">‚¨á Down</button>
                        </div>
                        <input type="file" id="photo-input" accept="image/*" onchange="previewImage(event)" required>
                        <small style="color:red; display:block; margin-top:5px;">* Upload JPG/PNG only.</small>
                    </div>

                    <div class="input-group">
                        <label>1. Student Name (‡¶õ‡¶æ‡¶§‡ßç‡¶∞/‡¶õ‡¶æ‡¶§‡ßç‡¶∞‡ßÄ‡ß∞ ‡¶®‡¶æ‡¶Æ):</label>
                        <input type="text" name="student_name" id="s_name" required>
                    </div>

                    <div class="input-group">
                        <label>2. Father's / Mother's Name (‡¶™‡¶ø‡¶§‡ßÉ ‡¶¨‡¶æ ‡¶Æ‡¶æ‡¶§‡ßÉ‡ß∞ ‡¶®‡¶æ‡¶Æ):</label>
                        <input type="text" name="parent_name" id="p_name" required>
                    </div>

                    <div class="input-group">
                        <label>3. School / College Name (‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º / ‡¶Æ‡¶π‡¶æ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ß∞ ‡¶®‡¶æ‡¶Æ):</label>
                        <input type="text" name="school_college_name" id="s_name_school" required>
                    </div>

                    <div class="input-group">
                        <label>(I) Select Gender (‡¶≤‡¶ø‡¶Ç‡¶ó):</label>
                        <div class="radio-container">
                            <label class="radio-label"><input type="radio" name="gender" value="Male" required onclick="checkFormValidity()"> (a) Male</label>
                            <label class="radio-label"><input type="radio" name="gender" value="Female" onclick="checkFormValidity()"> (b) Female</label>
                            <label class="radio-label"><input type="radio" name="gender" value="Others" onclick="checkFormValidity()"> (c) Others</label>
                        </div>
                    </div>

                    <div class="input-group dob-container">
                        <div class="dob-box">
                            <label>(II) (b) Date of Birth (‡¶ú‡¶®‡ßç‡¶Æ ‡¶§‡¶æ‡ß∞‡¶ø‡¶ñ):</label>
                            <input type="date" name="dob" id="dob_input" required onchange="calculateAge()">
                        </div>
                        <div class="age-box">
                            <label>(a) Age (‡¶¨‡¶Ø‡¶º‡¶∏):</label>
                            <input type="text" name="age" id="age_display" readonly>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>4. Your Personal Address (‡¶®‡¶ø‡¶ú‡ß∞ ‡¶†‡¶ø‡¶ï‡¶®‡¶æ):</label>
                        <textarea name="personal_address" id="per_address" rows="2" required></textarea>
                    </div>

                    <div class="input-group magic-box">
                        <label>5. Select Medium (‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ ‡¶¨‡¶æ‡¶õ‡¶®‡¶ø ‡¶ï‡ß∞‡¶ï):</label>
                        <div class="radio-container">
                            <label class="radio-label"><input type="radio" name="medium" value="Assamese" required onclick="checkFormValidity()"> Assamese Medium</label>
                            <label class="radio-label"><input type="radio" name="medium" value="English" onclick="checkFormValidity()"> English Medium</label>
                        </div>
                    </div>

                    <div class="input-group" style="background:#ffffcc; padding:15px; border-radius:10px;">
                        <label style="color:red; font-size:1.1rem; font-weight:bold;">6. Select Course Type (‡¶ï‡ßã‡ß∞‡ßç‡¶ö‡ß∞ ‡¶™‡ßç‡ß∞‡¶ï‡¶æ‡ß∞):</label>
                        <div class="radio-container">
                            <label class="radio-label"><input type="radio" name="course_type" value="School_Classes" onclick="toggleCourse('school')" required> School Classes</label>
                            <label class="radio-label"><input type="radio" name="course_type" value="Competitive_Exams" onclick="toggleCourse('competitive')"> Competitive Exams</label>
                        </div>
                    </div>

                    <div id="school-section" class="hidden-el magic-box">
                        <div class="input-group">
                            <label>Select Class (‡¶∂‡ßç‡ß∞‡ßá‡¶£‡ßÄ ‡¶¨‡¶æ‡¶õ‡¶®‡¶ø ‡¶ï‡ß∞‡¶ï):</label>
                            <select name="class_selected" id="class_select" onchange="handleClassChange()">
                                <option value="">-- Select Class --</option>
                                <option value="Class 6">Class 6th</option>
                                <option value="Class 7">Class 7th</option>
                                <option value="Class 8">Class 8th</option>
                                <option value="Class 9">Class 9th</option>
                                <option value="Class 10">Class 10th</option>
                                <option value="Class 11">Class 11th</option>
                                <option value="Class 12">Class 12th</option>
                            </select>
                        </div>
                        
                        <div id="stream-section" class="input-group hidden-el" style="background:#e6e6fa; padding:10px; border-radius:5px;">
                            <label>Select Stream (Arts/Commerce):</label>
                            <div class="radio-container">
                                <label class="radio-label"><input type="radio" name="stream" value="Arts" onclick="handleStreamChange('Arts')"> Arts</label>
                                <label class="radio-label"><input type="radio" name="stream" value="Commerce" onclick="handleStreamChange('Commerce')"> Commerce</label>
                            </div>
                        </div>
                        
                        <div id="subject-checkbox-container" class="hidden-el">
                            <label>Select Subjects (‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º ‡¶¨‡¶æ‡¶õ‡¶®‡¶ø ‡¶ï‡ß∞‡¶ï):</label>
                            <div id="dynamic-subjects" style="display:flex; flex-direction:column; gap:10px;"></div>
                            
                            <button type="button" id="btn-save-subjects" class="save-btn-small" onclick="saveSubjects()">‚úî Save Selected Subjects</button>
                            
                            <div id="saved-subjects-display" class="saved-list"></div>
                            <input type="hidden" name="final_subjects" id="final_subjects_input">
                        </div>
                    </div>

                    <div id="competitive-section" class="hidden-el magic-box">
                        <div class="input-group">
                            <label>Select Courses (‡¶ï‡ßã‡ß∞‡ßç‡¶ö ‡¶¨‡¶æ‡¶õ‡¶®‡¶ø ‡¶ï‡ß∞‡¶ï):</label>
                            <div style="display:flex; flex-direction:column; gap:10px;">
                                <label class="radio-label"><input type="checkbox" class="comp-course" value="ADRE" onchange="checkCourseSelection()"> ADRE</label>
                                <label class="radio-label"><input type="checkbox" class="comp-course" value="ASSAM POLICE" onchange="checkCourseSelection()"> ASSAM POLICE</label>
                                <label class="radio-label"><input type="checkbox" class="comp-course" value="ASSAM TET" onchange="checkCourseSelection()"> ASSAM TET</label>
                                <label class="radio-label"><input type="checkbox" class="comp-course" value="DHS" onchange="checkCourseSelection()"> DHS</label>
                                <label class="radio-label"><input type="checkbox" class="comp-course" value="OTHERS" onchange="checkCourseSelection()"> OTHERS</label>
                            </div>
                            
                            <button type="button" id="btn-save-courses" class="save-btn-small" onclick="saveCourses()">‚úî Save Selected Courses</button>
                            
                            <div id="saved-courses-display" class="saved-list"></div>
                            <input type="hidden" name="final_courses" id="final_courses_input">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>7. Mobile Number (‡¶Æ‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡ß∞):</label>
                        <input type="tel" name="phone" id="phone" required pattern="[0-9]{10}" placeholder="10 Digit Number">
                    </div>

                    <div class="input-group">
                        <label>8. Email Address (‡¶á-‡¶Æ‡ßá‡¶á‡¶≤) - Optional:</label>
                        <input type="email" name="email" id="email" placeholder="Optional">
                    </div>

                    <button type="submit" id="submit-btn" class="submit-btn" disabled>üîí Fill All Fields to Unlock</button>

                </form>
            </div>

            <div id="success-message">
                <div style="font-size:4rem; color:green;">‚úî</div>
                <h2 style="color:green;">SUBMITTED SUCCESSFULLY!</h2>
                <p>Your admission form has been received.</p>
                <div class="location-box" style="background:#1a0066; color:white; padding:10px; margin-top:10px;">
                    üìç MAYONG BAZAR, RAJAMAYONG
                </div>
                
                <button onclick="downloadReceipt()" style="background:#0044ff; color:white; padding:15px 30px; border:none; border-radius:30px; cursor:pointer; font-weight:bold; margin-top:20px; font-size:1.1rem; box-shadow: 0 5px 15px rgba(0,68,255,0.4);">
                    üì• DOWNLOAD RECEIPT (PDF)
                </button>
                
                <br><br>
                <button onclick="location.reload()" style="padding:10px 20px; margin-top:20px; cursor:pointer;">Fill New Form</button>
            </div>

            <div id="receipt-template">
                <div class="rec-header">
                    <h1 style="margin:0; color:#1a0066; font-size:24px;">THE CATALYST ASSAM</h1>
                    <p style="margin:5px 0;">ADMISSION ACKNOWLEDGEMENT RECEIPT</p>
                    <p style="margin:0; font-size:12px;">Mayong Bazar, Rajamayong, Morigaon</p>
                </div>
                
                <div style="display:flex; justify-content:space-between; align-items: flex-start;">
                    <div style="width:65%;">
                        <div class="rec-row"><div class="rec-label">Student Name:</div><div class="rec-val" id="r_name"></div></div>
                        <div class="rec-row"><div class="rec-label">Father/Mother:</div><div class="rec-val" id="r_parent"></div></div>
                        <div class="rec-row"><div class="rec-label">Mobile:</div><div class="rec-val" id="r_phone"></div></div>
                        <div class="rec-row"><div class="rec-label">Course Type:</div><div class="rec-val" id="r_type"></div></div>
                        <div class="rec-row"><div class="rec-label">Class/Course:</div><div class="rec-val" id="r_course"></div></div>
                        <div class="rec-row"><div class="rec-label">Medium:</div><div class="rec-val" id="r_medium"></div></div>
                        <div class="rec-row"><div class="rec-label">Date:</div><div class="rec-val" id="r_date"></div></div>
                    </div>
                    <div style="width:30%; text-align:center;">
                        <img id="r_photo" src="" style="width:120px; height:150px; object-fit:cover; border:2px solid #000;">
                        <p style="font-size:12px; margin-top:5px;">Student Photo</p>
                    </div>
                </div>
                
                <div style="margin-top:40px; display:flex; justify-content:space-between;">
                    <div>
                        <p>___________________</p>
                        <p>Student Signature</p>
                    </div>
                    <div>
                        <p>___________________</p>
                        <p>Office Seal & Sign</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- NAVIGATION LOGIC ---
        function switchToForm() {
            document.getElementById('homeView').style.display = 'none';
            document.getElementById('formView').style.display = 'block';
            window.scrollTo(0,0);
        }

        function switchToHome() {
            document.getElementById('formView').style.display = 'none';
            document.getElementById('homeView').style.display = 'block';
            window.scrollTo(0,0);
        }

        // =======================================================
        // YOUR SCRIPT URL (UNCHANGED)
        // =======================================================
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxSjEI7bVjF2jRQMqp2AOZFfTyzn90qFA72nL-WvOgpDBdafQzhRDw5RdAZItlC1amk/exec"; 
        // =======================================================

        let photoData = "";
        let currentPos = 20;

        function movePhoto(amount) {
            let img = document.getElementById('preview-img');
            currentPos += amount;
            if(currentPos < 0) currentPos = 0; if(currentPos > 100) currentPos = 100;
            img.style.objectPosition = `center ${currentPos}%`;
        }

        function previewImage(event) {
            let file = event.target.files[0];
            if(file) {
                let reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('preview-img').src = e.target.result;
                    photoData = e.target.result; 
                };
                reader.readAsDataURL(file);
            }
            checkFormValidity();
        }

        function calculateAge() {
            let dob = new Date(document.getElementById("dob_input").value);
            let diff = Date.now() - dob.getTime();
            let age = new Date(diff).getUTCFullYear() - 1970;
            document.getElementById("age_display").value = age + " Years";
            checkFormValidity();
        }

        function toggleCourse(type) {
            document.getElementById('school-section').style.display = (type === 'school') ? 'block' : 'none';
            document.getElementById('competitive-section').style.display = (type === 'school') ? 'none' : 'block';
            
            // Reset Selections
            document.getElementById('final_subjects_input').value = "";
            document.getElementById('final_courses_input').value = "";
            document.getElementById('saved-subjects-display').style.display = 'none';
            document.getElementById('saved-courses-display').style.display = 'none';
            document.getElementById('btn-save-subjects').style.display = 'none';
            document.getElementById('btn-save-courses').style.display = 'none';
            
            checkFormValidity();
        }

        function handleClassChange() {
            let cls = document.getElementById('class_select').value;
            let streamSec = document.getElementById('stream-section');
            let subjContainer = document.getElementById('subject-checkbox-container');
            
            document.getElementsByName('stream').forEach(r => r.checked = false);
            
            // Reset Button & Data
            document.getElementById('btn-save-subjects').style.display = 'none';
            document.getElementById('final_subjects_input').value = "";
            document.getElementById('saved-subjects-display').style.display = 'none';

            if (cls === "Class 11" || cls === "Class 12") {
                streamSec.style.display = 'block';
                subjContainer.style.display = 'none';
            } else if (cls !== "") {
                streamSec.style.display = 'none';
                renderSubjects(['MATHS', 'SCIENCE', 'ENGLISH', 'SOCIAL SCIENCE']);
                subjContainer.style.display = 'block';
            } else {
                streamSec.style.display = 'none';
                subjContainer.style.display = 'none';
            }
            checkFormValidity();
        }

        function handleStreamChange(stream) {
            let subjects = (stream === 'Arts') ? ['ECONOMICS', 'ENGLISH', 'GEOGRAPHY', 'POL. SCIENCE'] : ['ACCOUNTANCY', 'BUSINESS STUDIES', 'ECONOMICS', 'ENGLISH'];
            renderSubjects(subjects);
            document.getElementById('subject-checkbox-container').style.display = 'block';
            
            // Reset Button
            document.getElementById('btn-save-subjects').style.display = 'none';
            document.getElementById('final_subjects_input').value = "";
            
            checkFormValidity();
        }

        function renderSubjects(arr) {
            let container = document.getElementById('dynamic-subjects');
            container.innerHTML = "";
            arr.forEach(sub => {
                container.innerHTML += `<label class="radio-label"><input type="checkbox" class="school-subj" value="${sub}" onchange="checkSubjectSelection()"> ${sub}</label>`;
            });
        }

        function checkSubjectSelection() {
            var checkboxes = document.querySelectorAll('.school-subj:checked');
            var btn = document.getElementById('btn-save-subjects');
            if(checkboxes.length > 0) {
                btn.style.display = 'block';
            } else {
                btn.style.display = 'none';
            }
        }

        function checkCourseSelection() {
            var checkboxes = document.querySelectorAll('.comp-course:checked');
            var btn = document.getElementById('btn-save-courses');
            if(checkboxes.length > 0) {
                btn.style.display = 'block';
            } else {
                btn.style.display = 'none';
            }
        }

        function saveSubjects() {
            let list = [];
            document.querySelectorAll('.school-subj:checked').forEach(c => list.push(c.value));
            document.getElementById('saved-subjects-display').innerHTML = "Selected: " + list.join(", ");
            document.getElementById('saved-subjects-display').style.display = 'block';
            document.getElementById('final_subjects_input').value = list.join(", ");
            checkFormValidity();
        }

        function saveCourses() {
            let list = [];
            document.querySelectorAll('.comp-course:checked').forEach(c => list.push(c.value));
            document.getElementById('saved-courses-display').innerHTML = "Selected: " + list.join(", ");
            document.getElementById('saved-courses-display').style.display = 'block';
            document.getElementById('final_courses_input').value = list.join(", ");
            checkFormValidity();
        }

        function checkFormValidity() {
            let btn = document.getElementById("submit-btn");
            let isValid = true;
            
            if(document.getElementById('s_name').value === "") isValid = false;
            if(document.getElementById('p_name').value === "") isValid = false;
            if(document.getElementById('s_name_school').value === "") isValid = false;
            if(document.getElementById('phone').value === "") isValid = false;
            if(document.getElementById('dob_input').value === "") isValid = false;
            if(!photoData) isValid = false;
            if(!document.querySelector('input[name="gender"]:checked')) isValid = false;
            if(!document.querySelector('input[name="medium"]:checked')) isValid = false;

            let cType = document.querySelector('input[name="course_type"]:checked');
            if (cType) {
                if (cType.value === "School_Classes") {
                    if (document.getElementById('final_subjects_input').value === "") isValid = false;
                } else {
                    if (document.getElementById('final_courses_input').value === "") isValid = false;
                }
            } else { isValid = false; }

            if (isValid) {
                btn.disabled = false;
                btn.classList.add("active");
                btn.innerHTML = "SUBMIT FORM (‡¶´‡ß∞‡ßç‡¶Æ ‡¶¶‡¶æ‡¶ñ‡¶ø‡¶≤ ‡¶ï‡ß∞‡¶ï)";
            } else {
                btn.disabled = true;
                btn.classList.remove("active");
                btn.innerHTML = "üîí Fill All Fields & Save to Unlock";
            }
        }

        // --- PDF DOWNLOAD FUNCTION ---
        function downloadReceipt() {
            document.getElementById('r_name').innerText = document.getElementById('s_name').value;
            document.getElementById('r_parent').innerText = document.getElementById('p_name').value;
            document.getElementById('r_phone').innerText = document.getElementById('phone').value;
            let type = document.querySelector('input[name="course_type"]:checked');
            document.getElementById('r_type').innerText = type ? type.value : '';
            
            document.getElementById('r_course').innerText = document.getElementById('final_subjects_input').value || document.getElementById('final_courses_input').value;
            let med = document.querySelector('input[name="medium"]:checked');
            document.getElementById('r_medium').innerText = med ? med.value : '';
            
            document.getElementById('r_date').innerText = new Date().toLocaleDateString();
            document.getElementById('r_photo').src = photoData;

            // Generate PDF
            var element = document.getElementById('receipt-template');
            element.style.display = 'block'; 
            var opt = {
                margin: 10,
                filename: 'Catalyst_Receipt_' + document.getElementById('s_name').value + '.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                element.style.display = 'none'; // Hide after download
            });
        }

        document.getElementById('my-form').addEventListener('submit', function(e) {
            e.preventDefault();
            document.getElementById('loading-overlay').style.display = 'block';

            let formData = new FormData(this);
            let obj = {};
            formData.forEach((value, key) => obj[key] = value);
            obj.photo = photoData;

            fetch(SCRIPT_URL, {
                method: "POST",
                mode: "no-cors",
                body: JSON.stringify(obj),
                headers: { "Content-Type": "application/json" }
            })
            .then(() => {
                document.getElementById('loading-overlay').style.display = 'none';
                document.getElementById('form-section').style.display = 'none';
                document.getElementById('success-message').style.display = 'block';
                window.scrollTo(0,0);
            })
            .catch(err => {
                document.getElementById('loading-overlay').style.display = 'none';
                alert("Submission Failed! Check your internet.");
            });
        });
    </script>

</body>
</html>